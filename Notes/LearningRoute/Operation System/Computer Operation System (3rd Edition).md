# Computer Operation System (3rd Edtion)

## 第一章、绪论
### 1.1 操作系统在计算机中的地位
#### 1.1.1 存储程序式计算机的结构和特点
Von Neumann 总结了手工操作的规律以及前人研究计算机的经验，于 20 世纪 40 年代提出了 `“存储程序式计算机”` 方案，即`冯诺依曼计算机体系结构`，实现了计算的自动化。

![](Pasted%20image%2020210618163240.png)

##### Von Neumann 计算机体系结构
###### 1. CPU
CPU 是一种能够`解释指令`、`执行指令`、`控制操作顺序` 的硬件设备。
它由：
- ALU （算术逻辑单元）
- 控制单元

构成。

###### 2. Main Memory
简称`主存`，其作用是存放 `指令`和`数据`，并能由 CPU 直接`随机存取`。

The composition of Main Memory：
- MAR (Memory Address Register)
- MDR (Memory Data Register)
- CR (Command Register)


###### 3. I/O 设备
负责信息的传输，将数据从外部世界传送到计算机内，或将主存中的内容传输到计算机的外部世界。

#### 1.1.2 OS 与 CS 各层级的关系
> 软件的定义：软件由`程序`、`数据`、`各种文档资料` 组成，是方便用户和充分发挥计算机效能的各种程序的总称。

软件可分为以下3类：
1. 系统软件：OS、编译程序、程序设计语言等。
2. 应用软件
3. 工具软件

🌟 OS 管理系统中的各种软、硬件，控制用户和应用程序的工作流程，将系统各部件有机地融合成一个整体，使计算机真正体现了系统的**完整性**和**可利用性**。

CS 的组成：

![](Pasted%20image%2020210618163839.png)


在 CS 中，OS 的位置处在硬件和其他所有软件之间。它在裸机上运行，是所有软件中与硬件相连的`第一层软件`。

OS 与各层之间的关系表现体现在两个方面：
1. OS 对各层的管理和控制。
	- **OS 直接与硬件交互**
		控制 CPU 的工作、访问存储器、进行设备驱动、设备中断处理。
	- **OS 与用户和应用程序交互**
		OS 是其他系统软件和应用程序的运行基础。
		它为上层软件和用户提供运行环境，即**提供方便、简单的用户接口**。
2. 各层对 OS 的制约。
	- 计算机体系结构对 OS 实现技术的制约
	- 用户和应用程序的需求对 OS 实现技术的制约
#### 1.1.3 OS 与计算机体系结构的关系
早期计算机上的 OS 为单用户操作系统。

由于计算机系统的计算模型是`顺序计算模型`，其特点是 **集中顺序过程控制**，而 OS 需要支持的是 `并行计算模型` （多用户、多任务的同时执行）。

因此就产生了矛盾：硬件结构的顺序计算模型和 OS 的并行计算模型相矛盾。

为了解决这一矛盾，出现了：
1. 多处理机系统 
2. 消息传递型多计算机
3. 计算机网络

### 1.2 操作系统的形成和发展
#### 初级阶段
##### 1. 早期批处理
##### 2. 联机批处理
##### 3. 脱机批处理
##### 4. 执行系统
#### OS 的形成
##### 1. 多道程序设计技术
多道程序运行的特征：
1. 多道
2. 宏观上并行
3. 微观上串行
##### 2. 分时技术
#### 进一步发展
现代操作系统，略
### 1.3 操作系统的基本概念
#### 1.3.1 OS 的定义和特性
##### 1. OS 的定义
操作系统是核心**系统软件**
1. 负责计算机系统软、硬件资源的分配和使用；
2. 控制和协调并发活动；
3. 提供用户接口，使用户获得良好的工作环境。

##### 2. OS 的特性
为了充分利用计算机系统的资源，OS 一般采用多个同时性用户共享的策略。

> 由于当前计算机大多数任然是以`顺序计算`为基础的`存储程序式计算机`，所以 OS 在解决 **并行处理问题** 时，采用了 `多道程序设计` 和 `分时技术` 等。
> 由于操作系统要随时处理各种事件，所以它也具备不确定性。

以多道程序设计为基础的 OS 具备的主要特征就是：`并发`与`共享`。
1. **并发**
	又称为共行行，是指能处理多个同时性活动的能力。
	在单机操作系统中，是逻辑上的并行。
	在多处理机系统或多计算机系统，是真正的并行。
2. **共享**
	共享是指多个计算任务对系统资源的共同享用。
3. **不确定性**

#### 1.3.2 OS 的资源管理功能
OS 的主要功能包括 3 方面：
1. 对系统资源实施管理和调度
2. 控制和协调并发活动
3. 对外提供用户界面。

`系统资源管理` 和 `并发活动` 的控制是 OS 的**核心功能**。

OS 的资源管理的目标和 OS 的宗旨是一样的：提高系统资源的利用率和方便用户使用。

##### 1. 处理机管理
##### 2. 存储器管理
##### 🌟3. 设备管理
现代 OS 的设备管理主要解决了以下 3 个问题：
1. 设备无关性
2. 设备分配
3. 设备的传输控制
4. 文件系统

#### 1.3.3 OS 应解决的基本问题
##### 1. 资源分配的策略和方法
##### 2. 协调并发活动的关系
##### 3. 保证数据的一致性
##### 4. 实现数据的存取控制

### 1.4 操作系统的基本类型
#### 1. 批量操作系统
#### 2. 分时操作系统
#### 3. 实时操作系统
#### 4. 个人计算机操作系统
#### 5. 网络操作系统
#### 6. 分布式操作系统
### 1.5 操作系统采用的关键技术
#### 1. 并行处理技术
#### 2. 虚拟技术
### 1.6 UNIX、Linux 操作系统概述
### 习题 1

## 第二章、操作系统的结构和硬件支持
### 2.1 操作系统虚拟机
配置在裸机上的第一层软件是操作系统。
在裸机上配置了操作系统后就构成了 `OS 虚拟机`。

OS 所提供的全部操作命令的集合称为 `操作命令语言`，它是用户和系统进行通信的手段和界面。分为两个方面：
1. 操作命令（命令接口）
	1. 键盘命令
	2. 作业控制命令
	3. 图形化用户界面
2. 系统功能调用（程序接口）
   在用户程序中可以直接使用系统功能调用请求 OS 提供的服务。
### 2.2 操作系统的组织结构
操作系统的组织结构包括：
1. 模块结构
2. 接口
3. 运行时的组织结构

#### 1. OS 的结构
![](Pasted%20image%2020210618203505.png)
OS 的设计中，有 4 中方法：
1. 单体结构（无结构）
	效率高，难理解，难维护
2. 模块结构
	性能退化，易理解，易维护
3. 可扩展内核结构
	将 OS 分为 基础核心 和 其他核心功能。
4. 🌟层次结构
	OS 是由若干层组成，每一层提供一套功能，并且该功能仅依赖于该层以内的各层。
	
	![](Pasted%20image%2020210618204806.png)
	
	与机器硬件（裸机）紧挨着的是 `系统核`（基础核心）。
	系统核包括 **初级中断处理**、**外部设备驱动**、**在进程之间切换处理机**以及**实施进程控制和通信** 的功能，其 `目的` 是提供一种 `进程可以存在和活动的环境`。
	系统核以外各层依次是 存储管理、I/O 处理层、文件存取层、资源分配和调度层。他们具有 `资源管理功能` 和 `为用户提供服务`。
	
#### 2. 运行时的组织结构
在 OS 运行过程中调用一个给定的 OS 内部例程有两种方式：
1. 系统功能调用方式
2. C/S 方式
	
#### 3. OS 与 CS 各层次的接口
OS 处在 CS 中硬件层和其他所有软件之间的位置，它在裸机上运行，是系统软件和应用程序运行的基础。**它与硬件、应用程序和用户都有接口**

![](Pasted%20image%2020210618210915.png)

OS 必须响应系统运行时的并发事件，需要两种硬件机制提供支持：
1. 处理机的不同状态
2. 中断和陷入
### 2.3 处理机的特权级
#### 🌟2.3.1 处理机的态及分类
在 OS 中运行着大量程序，分为两大类：
1. OS 的管理程序
2. 用户程序

管理程序不能被破坏，因此必须为其在 OS 中提供一个保护环境。
根据对资源和机器指令的使用权限，将处理执行的工作状态区分为不同的态（模式）。
处理机的`态`，又称为处理机的`特权级`。就是处理机当前处于何种状态，正在执行哪类程序。
##### 1. Supervisor Mode （管态、系统态）
##### 2. User Mode （用户态、目态）
##### 2. Kernel Mode （核态）

##### 3. 在下列情况下，会由用户态自动转向管态：
- 用户进程访问操作系统，要求操作系统的某种服务，这种访问称为系统功能调用。
- 在用户程序执行时，发生一次中断（如 I/O 完成中断）。
- 在一个用户进程中产生一个错误状态，这种状态被处理为程序性中断。
- 在用户态下企图执行一条特权指令，作为一种特殊类型的错误，并按情况3处理。

从管态返回用户态是用一条指令实现的，这条指令本身也是特权指令。

### 2.4 中断及其处理
#### 2.4.1 中断概念及类型
##### 1. 中断概念
为了实现并发活动以及计算机系统的自动化工作，系统必须具备处理中断的能力。
**中断：** 指某个事件（例如电源掉电、定点加法溢出或 I/O 传输结束等）发生时，系统中止现行程序的运行、引出处理该事件的程序进行处理，处理完毕后返回断点，继续执行。

![](Pasted%20image%2020210618224156.png)


##### 🌟2. 中断类型

###### 1. 按中断功能分类
1. 输入输出中断
2. 外中断
3. 机器故障中断
4. 程序性中断
5. 访管中断

###### 2. 按中断方式分类
1. 强迫性中断
2. 自愿中断

按功能所分的 5 大类中，只有访管中断属于自愿中断类型，其他属于强迫性中断。
###### 3. 按中断来源分类

1. 中断（外中断、异步中断）
2. 俘获（异常）

### 2.5 UNIX、Linux 系统结构
### 2.6 Linux 系统的特权级与中断处理
### 习题 2

## 第三章、操作系统的用户接口
### 3.1 用户工作环境
### 3.2 用户接口
### 3.3 系统功能调用
### 3.4 UNIX 系统功能调用
### 3.5 Linux 系统功能调用
### 习题 3

## 第四章、进程及进程管理
### 4.1 进程引入
### 4.2 进程概念
### 4.3 进程控制
### 4.4 进程之间的约束关系
### 4.5 同步机构
### 4.6 进程互斥与同步的实现
### 4.7 进程通信
### 4.8 线程概念及特点
### 4.9 操作系统的并发机制实例
### 4.10 UNIX 系统的进程管理
### 4.11 Linux 系统的进程管理
### 习题 4

## 第五章、资源分配与调度
### 5.1 资源管理概述
### 5.2 资源管理的机制和策略
### 5.3 死锁
### 习题 5

## 第六章、处理机调度
### 6.1 处理机的多级调度
### 6.2 作业调度
### 6.3 进程调度
### 6.4 线程调度
### 6.5 UNIX 系统的进程调度
### 6.6 Linux 系统的进程调度
### 习题 6

## 第七章、主存管理
### 7.1 主存管理概述
### 7.2 主存管理的功能
### 7.3 分区存储管理及存在的问题
### 7.4 页式存储管理
### 7.5 段式和段页式存储管理
### 7.6 UNIX 系统的存储管理
### 7.7 Linux 系统的存储管理
### 习题 7

## 第八章、设备管理
### 8.1 设备管理概述
### 8.2 缓冲技术
### 8.3 设备分配
### 8.4 输入、输出控制
### 8.5 UNIX 系统的设备管理
### 8.6 Linux 系统的设备驱动
### 习题 8

## 第九章、文件系统
### 9.1 文件系统概述
### 9.2 文件的逻辑结构和存取方法
### 9.3 文件的物理结构
### 9.4 文件存储空间的管理
### 9.5 文件目录
### 9.6 共享和安全
### 9.7 文件操作与文件备份
### 9.8 UNIX 文件系统的主要结构及实现
### 9.9 Linux 文件系统
### 习题 9

## 模拟试题1
## 模拟试题2


